#!/bin/bash
# ------------------------------------------------------------  
# auto_zip.sh
# ------------------------------------------------------------

# ------------------------------------------------------------
# main
# ------------------------------------------------------------
main() {
  local _dir="lambda_code"
  local _zip_file="lambda_function.zip"

  # ------------------------------------------------------------
  # ディレクトリの作成
  # ------------------------------------------------------------
  mkdir -p "${_dir}"

  # ------------------------------------------------------------
  # ファイルのコピー
  # ------------------------------------------------------------
  cp -p index.js "${_dir}"/
  cp -rp node_modules "${_dir}"/
  cp -p package.json "${_dir}"/
  
  # ------------------------------------------------------------
  # zipファイルの作成
  # ------------------------------------------------------------
  cd "${_dir}"
  zip -r ../"${_zip_file}" .
  cd ..
  rm -rf "${_dir}"

  return 0
}

main "$@"
exit $?
